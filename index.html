<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Chuyá»ƒn PDF thÃ nh vÄƒn báº£n khÃ´ng dáº¥u</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    textarea { width: 100%; height: 400px; margin-top: 15px; font-size: 14px; white-space: pre-wrap; }
    #status { margin: 10px 0; color: green; }
  </style>
</head>
<body>

<h3>ğŸ“„ Xuáº¥t vÄƒn báº£n tá»« PDF âœ KhÃ´ng dáº¥u</h3>
<input type="file" id="pdfInput" accept="application/pdf">
<div id="status">ChÆ°a xá»­ lÃ½</div>
<textarea id="output" placeholder="VÄƒn báº£n sáº½ hiá»ƒn thá»‹ á»Ÿ Ä‘Ã¢y..."></textarea>

<script src="https://cdn.jsdelivr.net/npm/pdfjs-dist@3.4.120/build/pdf.min.js"></script>
<script>
pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdn.jsdelivr.net/npm/pdfjs-dist@3.4.120/build/pdf.worker.min.js';

// HÃ m bá» dáº¥u tiáº¿ng Viá»‡t
function removeVietnamese(str) {
  return str.normalize("NFD")
            .replace(/[\u0300-\u036f]/g, "")
            .replace(/Ä‘/g, "d").replace(/Ä/g, "D");
}

document.getElementById('pdfInput').addEventListener('change', async (e) => {
  const file = e.target.files[0];
  if (!file) return;

  const status = document.getElementById('status');
  const output = document.getElementById('output');
  output.value = '';
  status.innerText = 'ğŸ“¥ Äang Ä‘á»c file PDF...';

  try {
    const arrayBuffer = await file.arrayBuffer();
    const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
    let fullText = '';

    for (let i = 1; i <= pdf.numPages; i++) {
      const page = await pdf.getPage(i);
      const textContent = await page.getTextContent();
      const pageText = textContent.items.map(item => item.str).join('\n');
      fullText += pageText + '\n\n';
    }

    const noAccent = removeVietnamese(fullText.toLowerCase());
    output.value = noAccent;
    status.innerText = 'âœ… HoÃ n táº¥t! ÄÃ£ loáº¡i bá» dáº¥u tiáº¿ng Viá»‡t.';
  } catch (err) {
    console.error(err);
    status.innerText = 'âŒ Lá»—i khi xá»­ lÃ½ PDF.';
  }
});
</script>

</body>
</html>